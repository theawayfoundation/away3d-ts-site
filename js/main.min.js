var kurst;(function(b){(function(c){var d=(function(){function e(){this.loader=new XMLHttpRequest()}e.prototype.loadJson=function(g){if(!this.loader){this.loader=new XMLHttpRequest()}var f=this;this.loader.open("GET",g,true);this.loader.onload=function(h){f.onLoadComplete(h)};this.loader.onerror=function(h){f.onLoadError(h)};this.loader.responseType="text";this.loader.send()};e.prototype.getData=function(){return this.jsonData};e.prototype.getJSONString=function(){return this.jsonString};e.prototype.setLoadCallback=function(h,f,g){this.target=h;this.loadedCallback=f;this.loadErrorCallback=g};e.prototype.onLoadComplete=function(f){var g=f.currentTarget;this.jsonData=JSON.parse(g.responseText);this.jsonString=g.responseText;if(this.loadedCallback){this.loadedCallback.apply(this.target)}};e.prototype.onLoadError=function(f){var g=f.currentTarget;g.abort();if(this.loadErrorCallback){this.loadErrorCallback.apply(this.target)}};return e})();c.JSonLoader=d})(b.utils||(b.utils={}));var a=b.utils})(kurst||(kurst={}));var kurst;(function(b){(function(c){var d=(function(){function e(){this.jsLoader=new b.utils.JSonLoader();this.jsLoader.setLoadCallback(this,this.jsonLoaded,this.jsonLoadError)}e.prototype.loadSpreadSheet=function(f){this.jsLoader.loadJson("https://spreadsheets.google.com/feeds/list/"+f+"/od6/public/values?alt=json")};e.prototype.setLoadCallback=function(h,f,g){this.target=h;this.loadedCallback=f;this.loadErrorCallback=g};e.prototype.getData=function(){return this.gSheetData};e.prototype.getHead=function(){return this.gSheetHead};e.prototype.getJSONString=function(){return this.jsLoader.getJSONString()};e.prototype.parseData=function(g){this.gSheetHead=[];this.gSheetData=[];var n=g.feed["entry"];var l=n[0];var h="gsx$";var f;var m;var o;for(var k in l){if(k.indexOf(h)!=-1){this.gSheetHead.push(k.slice(h.length,k.length))}}for(var j=0;j<n.length;j++){f=n[j];o=new Object();for(var i=0;i<this.gSheetHead.length;i++){m=this.gSheetHead[i];o[m]=f[h+m].$t}this.gSheetData.push(o)}};e.prototype.jsonLoaded=function(){this.jsonData=this.jsLoader.getData();this.parseData(this.jsonData);if(this.loadedCallback){this.loadedCallback.apply(this.target)}};e.prototype.jsonLoadError=function(){if(this.loadErrorCallback){this.loadErrorCallback.apply(this.target)}};return e})();c.GSpreadSheetLoader=d})(b.utils||(b.utils={}));var a=b.utils})(kurst||(kurst={}));var kurst;(function(b){(function(c){var d=(function(){function g(){}g.isAndroid=function m(){return navigator.userAgent.match(/Android/i)?true:false};g.isBlackBerry=function l(){return navigator.userAgent.match(/BlackBerry/i)?true:false};g.isIOS=function n(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)?true:false};g.isWindowsMob=function r(){return navigator.userAgent.match(/IEMobile/i)?true:false};g.isMobile=function o(){return(g.isAndroid()||g.isBlackBerry()||g.isIOS()||g.isWindowsMob())};g.getId=function h(s){return document.getElementById(s)};g.getClass=function q(s){return document.getElementsByClassName(s)};g.getElementsByClassNme=function j(z){var x=new Array();var v=document;var u=0;if(v.getElementsByClassName){var y=v.getElementsByClassName(z);for(u=0;u<y.length;u++){x.push(y[u])}}else{var w=new RegExp("\\b"+z+"\\b");var s=v.getElementsByTagName("*");for(u=0;u<s.length;u++){var t=s[u]["className"];if(w.test(t)){x.push(s[u])}}}return x};g.getQueryParams=function e(s){s=s.split("+").join(" ");var v={},u,t=/[?&]?([^=]+)=([^&]*)/g;while(u=t.exec(s)){v[decodeURIComponent(u[1])]=decodeURIComponent(u[2])}return v};g.isFireFox=function f(){return(navigator.userAgent.search("Firefox")!=-1)};g.isIE=function i(){return(navigator.appVersion.indexOf("MSIE")!=-1)};g.getIEVersion=function p(){if(g.isIE()){return parseFloat(navigator.appVersion.split("MSIE")[1])}return -1};g.isFlashEnabled=function k(){if(g.isIE()){var s=g.getIEVersion();if(s>8){return(window.ActiveXObject&&(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))!=false)}else{try{var t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(t){return true}return false}catch(u){return false}}return false}else{return((typeof navigator.plugins!="undefined"&&typeof navigator.plugins["Shockwave Flash"]=="object")!=false)}};return g})();c.JSUtils=d})(b.utils||(b.utils={}));var a=b.utils})(kurst||(kurst={}));var kurst;(function(b){(function(c){var d=(function(){function f(){}f.rgbToHex=function e(j){var n=/^rgb\(\s*(-?\d+)(%?)\s*,\s*(-?\d+)(%?)\s*,\s*(-?\d+)(%?)\s*\)$/;var i,m,l,h,k="";if((i=n.exec(j))){m=b.utils.NumberUtils.componentFromStr(i[1],i[2]);l=b.utils.NumberUtils.componentFromStr(i[3],i[4]);h=b.utils.NumberUtils.componentFromStr(i[5],i[6]);k="#"+(16777216+(m<<16)+(l<<8)+h).toString(16).slice(1)}return k};f.componentFromStr=function g(j,i){var h=Math.max(0,parseInt(j,10));return i?Math.floor(255*Math.min(100,h)/100):Math.min(255,h)};return f})();c.NumberUtils=d})(b.utils||(b.utils={}));var a=b.utils})(kurst||(kurst={}));var kurst;(function(a){(function(f){var e=(function(){function g(){this.creds="mr.doob / https://github.com/mrdoob/eventdispatcher.js/"}return g})();var d=(function(){function g(){this.listeners=new Array()}g.prototype.addEventListener=function(h,i){if(this.listeners[h]===undefined){this.listeners[h]=new Array()}if(this.listeners[h].indexOf(i)===-1){this.listeners[h].push(i)}};g.prototype.removeEventListener=function(i,j){var h=this.listeners[i].indexOf(j);if(h!==-1){this.listeners[i].splice(h,1)}};g.prototype.dispatchEvent=function(m){var h=this.listeners[m.type];if(h!==undefined){this.lFncLength=h.length;m.target=this;for(var k=0,j=this.lFncLength;k<j;k++){h[k].call(this,m)}}};return g})();f.EventDispatcher=d;var c=(function(){function g(h){this.type=h}return g})();f.Event=c})(a.event||(a.event={}));var b=a.event})(kurst||(kurst={}));var __extends=this.__extends||function(e,a){function c(){this.constructor=e}c.prototype=a.prototype;e.prototype=new c()};var kurst;(function(b){(function(c){var d=(function(e){__extends(f,e);function f(){e.call(this)}f.prototype.getId=function(g){return document.getElementById(g)};f.prototype.getClass=function(g){return document.getElementsByClassName(g)};f.prototype.getElementsByClassNme=function(o){var m=new Array();var k=document;var j=0;if(k.getElementsByClassName){var n=k.getElementsByClassName(o);for(j=0;j<n.length;j++){m.push(n[j])}}else{var l=new RegExp("\\b"+o+"\\b");var g=k.getElementsByTagName("*");for(j=0;j<g.length;j++){var h=g[j]["className"];if(l.test(h)){m.push(g[j])}}}return m};return f})(b.event.EventDispatcher);c.UIBase=d})(b.core||(b.core={}));var a=b.core})(kurst||(kurst={}));var KurstWebsite;(function(b){var a=(function(d){__extends(c,d);function c(){d.call(this);this.lastColour="#30353b";this.bgUpdateCounter=0;this.backgroundColour="#30353b";this.colourTween=new Object()}c.prototype.setColour=function(e){this.animateBackground(e)};c.prototype.resetBackground=function(){this.animateBackgroundToColour(this.backgroundColour)};c.prototype.animateBackground=function(e){this.animateBackgroundToColour(e)};c.prototype.animateBackgroundToColour=function(f){if(this.lastColour!=null){this.colourTween.color0=this.lastColour}TweenLite.killTweensOf(this.colourTween);var e=this;TweenLite.to(this.colourTween,6,{colorProps:{color0:f},onUpdate:function(){e.updateBackgroundTween()},onComplete:function(){e.completeBackgroundTween()}});this.bgUpdateCounter=0};c.prototype.updateBackgroundTween=function(){if(this.bgUpdateCounter%10==0){this.bgUpdateCounter=0;var e=this.colourTween.color0;this.lastColour=kurst.utils.NumberUtils.rgbToHex(e);this.getId("backgroundD").style.backgroundImage="radial-gradient(farthest-corner at center 180px, "+this.lastColour+" 0%, "+this.backgroundColour+" 620px)";this.getId("backgroundD").style.backgroundImage="-o-radial-gradient(center 180px, farthest-corner, "+this.lastColour+" 0%, "+this.backgroundColour+" 620px)";this.getId("backgroundD").style.backgroundImage="-webkit-radial-gradient(center 180px, farthest-corner, "+this.lastColour+" 0%, "+this.backgroundColour+" 620px)";this.getId("backgroundD").style.backgroundImage="-webkit-gradient(radial, 180px 180px, 0, 180px 0%, 813, color-stop(0%, "+this.lastColour+"), color-stop(620px, "+this.backgroundColour+"))"}this.bgUpdateCounter++};c.prototype.completeBackgroundTween=function(){this.bgUpdateCounter=0;var e=this.colourTween.color0;this.lastColour=kurst.utils.NumberUtils.rgbToHex(e);this.getId("backgroundD").style.backgroundImage="radial-gradient(farthest-corner at center 180px, "+this.lastColour+" 0%, "+this.backgroundColour+" 620px)";this.getId("backgroundD").style.backgroundImage="-o-radial-gradient(center 180px, farthest-corner, "+this.lastColour+" 0%, "+this.backgroundColour+" 620px)";this.getId("backgroundD").style.backgroundImage="-webkit-radial-gradient(center 180px, farthest-corner, "+this.lastColour+" 0%, "+this.backgroundColour+" 620px)";this.getId("backgroundD").style.backgroundImage="-webkit-gradient(radial, 180px 180px, 0, 180px 0%, 813, color-stop(0%, "+this.lastColour+"), color-stop(620px, "+this.backgroundColour+"))"};return c})(kurst.core.UIBase);b.BackgroundGrad=a})(KurstWebsite||(KurstWebsite={}));var KurstWebsite;(function(a){var b=(function(){function c(g,f,d,e){this.flashVideoURI="";this.htmlVideoURI="";this.htmlVideoFrameObj=new Object();this.contentHeightVideo="750px";this.contentHeightNoVideo="540px";this.currentSectionID=-1;this.divIIDCounter=0;this.clientLogoPath="media/images/";this.flashPlayerID="kurstVideoPlayer";this.sendJSONFncName="sendJSONToPlayer";this.flashVideoURI=d;this.htmlVideoURI=e;this.flashXQueue=[];this.container=f;this.$=g;this.init()}c.NEW_SECTION="new_section";c.VIDEO_COMPLETE="videoComplete";c.VIDEO_STARTED="videoStarted";c.prototype.receiveFlashVideoEvent=function(d){switch(d.type){case"complete":this.videoEnded();break;case"mouseLeave":break;case"frame":this.videoFrame(d);break;case"pause":break;case"play":this.videoStarted();break;case"bufferLoaded":break}};c.prototype.setData=function(d){this.videoData=d};c.prototype.setCallback=function(d,e){this.callbackObj=d;this.callbackFnc=e};c.prototype.sendJsonDataToFlash=function(f){var e=this.getFlashMovie();if(e){if(e.hasOwnProperty(this.sendJSONFncName)){e[this.sendJSONFncName](f)}else{clearInterval(this.flashXQueueTimeoutID);this.flashXQueue.push(f);var d=this;this.flashXQueueTimeoutID=setInterval(function(){d.processXQeue()},100)}}};c.prototype.init=function(){this.flashEnabled=kurst.utils.JSUtils.isFlashEnabled();this.callbackData=new Object();if(this.flashEnabled){this.initFlashVideoPlayer()}else{this.initHTMLVideoPlayer()}$("#clientList").css("visibility","visible");$("#servicesList").css("visibility","visible");$("#servicesDesc").css("visibility","visible");$("#"+this.container.id).css("height",this.contentHeightNoVideo)};c.prototype.showSection=function(d){if(Number(d.id)!=this.currentSectionID){this.showClientList(d);this.showServicesList(d);this.showServicesInfo(d);this.sendCallback(a.VideoPlayer.NEW_SECTION,d)}};c.prototype.sendCallback=function(d,e){if(this.callbackFnc){this.callbackData.type=d;if(e){this.callbackData.data=e}this.callbackFnc.apply(this.callbackObj,[this.callbackData])}};c.prototype.initFlashVideoPlayer=function(){var d={debug:"false",video_uri:this.flashVideoURI,proxy_uri:"k2013code/php/dataProxy.php",js_callback:"htmlVideoEvent"};var f={wmode:"direct",scale:"noscale",menu:"false",allowscriptaccess:"always",allowFullScreen:"true",bgcolor:"30353b"};var e={id:"kurstVideoPlayer",name:"kurstVideoPlayer"};swfobject.embedSWF("media/swf/KurstVideoPlayer.swf","videoPlayer","960","540","11.0.0","",d,f,e,null)};c.prototype.processXQeue=function(){if(this.flashXQueue.length==0){clearInterval(this.flashXQueueTimeoutID)}var d=this.getFlashMovie();if(d){if(d.hasOwnProperty(this.sendJSONFncName)){clearInterval(this.flashXQueueTimeoutID);for(var e=0;e<this.flashXQueue.length;e++){d.sendToPlayer(this.flashXQueue.pop())}}}};c.prototype.getFlashMovie=function(){if(kurst.utils.JSUtils.isIE()){return window[this.flashPlayerID]}else{return document[this.flashPlayerID]}};c.prototype.initHTMLVideoPlayer=function(){var e='<video controls width="960" height="540" id="htmlVideo">';e+='     <source src="'+this.htmlVideoURI+'" type="video/mp4" />';e+="</video>";$("#videoPlayer").css("visibility","visible");$("#videoPlayer").append(e);this.htmlVideoObject=$("#htmlVideo").get(0);var d=this;this.htmlVideoObject.addEventListener("playing",function(f){d.htmlVideoEvent(f)},false);this.htmlVideoObject.addEventListener("play",function(f){d.htmlVideoEvent(f)},false);this.htmlVideoObject.addEventListener("pause",function(f){d.htmlVideoEvent(f)},false);this.htmlVideoObject.addEventListener("ended",function(f){d.htmlVideoEvent(f)},false);this.htmlVideoObject.addEventListener("timeupdate",function(f){d.htmlVideoEvent(f)},false)};c.prototype.htmlVideoInterval=function(){this.htmlVideoFrameObj.currentFrame=Math.round(this.htmlVideoObject.currentTime*25);this.videoFrame(this.htmlVideoFrameObj)};c.prototype.htmlVideoEvent=function(d){switch(d.type){case"playing":break;case"play":this.videoStarted();break;case"timeupdate":break;case"ended":this.videoEnded();break;case"pause":break}};c.prototype.videoFrame=function(f){var g=parseInt(f.currentFrame);var i=this.videoData.length;var h;var e;var d;for(var j=0;j<i;j++){h=this.videoData[j];e=parseInt(h.sectionstart);d=parseInt(h.sectionend);if(g!=0){if(g>=e&&g<=d){if(this.currentSectionID!=h.id){this.currentSectionData=h;this.showSection(this.currentSectionData);this.currentSectionID=h.id}}}}};c.prototype.showDynamicVideoContent=function(e){if(e){if(!this.flashEnabled){var d=this;this.htmlVideoIID=setInterval(function(){d.htmlVideoInterval()},33)}$("#"+this.container.id).animate({height:this.contentHeightVideo},500,"easeOutQuad",function(){})}else{if(!this.flashEnabled){clearInterval(this.htmlVideoIID)}this.$("#videoContainer").animate({height:this.contentHeightNoVideo},1000,"easeOutQuad")}};c.prototype.videoEnded=function(){this.showDynamicVideoContent(false);this.sendCallback(a.VideoPlayer.VIDEO_COMPLETE)};c.prototype.videoStarted=function(){this.showDynamicVideoContent(true);this.sendCallback(a.VideoPlayer.VIDEO_STARTED)};c.prototype.showClientList=function(f){if(this.clientGroupDivID!=null){var e=this.clientGroupDivID;var d=this;$("#"+this.clientGroupDivID).animate({left:"960px"},{duration:500,easing:"easeInOutQuad",complete:function(){$("#"+e).remove();d.showNewClientList(f)}})}else{this.showNewClientList(f)}};c.prototype.showNewClientList=function(k){var f;var n;var e="";var i="";var l="";var m=k.clients.split(",");var g="clientLogoID_";var h="ClientGroup_"+(this.divIIDCounter++);var d="<div class='clientGroup' id='"+h+"'></div>";this.clientGroupDivID=h;$("#clientList").append(d);$("#"+h).css("left","-960px");$("#"+h).animate({left:"0px"},{duration:1000,easing:"easeOutQuad"});for(var j=0;j<m.length;j++){e=m[j];if(e.indexOf(".png")!=-1){i=this.clientLogoPath+e;l="<img src='"+i+"'>";n=g+(this.divIIDCounter++);f="<div class='clientLogoContainer' id='"+n+"'><div class='clientLogo'>"+l+"</div></div>";$("#"+h).append(f)}else{n=g+(this.divIIDCounter++);f="<div class='clientLogoContainer' id='"+n+"'><div class='clientLogo'>"+e+"</div></div>";$("#"+h).append(f)}}};c.prototype.showServicesList=function(f){if(this.servicesDivID!=null){var e=this.servicesDivID;var d=this;$("#"+this.servicesDivID).animate({left:"960px"},{duration:500,easing:"easeInOutQuad",complete:function(){$("#"+e).remove();d.showNewServicesList(f)}})}else{this.showNewServicesList(f)}};c.prototype.showNewServicesList=function(f){var g="servicesList_";var d=g+(this.divIIDCounter++);var e="<div class='servicesInfo' id='"+d+"'>"+f.services+"</div>";$("#servicesList").append(e);$("#"+d).css("left","-960px");$("#"+d).delay(100).animate({left:"0px"},{duration:1000,easing:"easeOutQuad"});this.servicesDivID=d};c.prototype.showServicesInfo=function(f){if(this.servicesInfoDivID!=null){var e=this.servicesInfoDivID;var d=this;$("#"+this.servicesInfoDivID).fadeOut("slow",function(){$("#"+e).remove();d.showNewServicesInfo(f)})}else{this.showNewServicesInfo(f)}};c.prototype.showNewServicesInfo=function(f){var g="servicesListInfo_";var d=g+(this.divIIDCounter++);var e="<div class='servicesDescContent' id='"+d+"'>"+f.info+"</div>";$("#servicesDesc").append(e);$("#"+d).hide();$("#"+d).delay(600).fadeIn(1000);this.servicesInfoDivID=d};return c})();a.VideoPlayer=b})(KurstWebsite||(KurstWebsite={}));var KurstWebsite;(function(b){var a=(function(){function c(d){this.expanded=false;this.$=d;this.init()}c.prototype.init=function(){$("#contentArea").hide();$("#contentArea").css("top","580px");$("#logoContainer").css("height","0px");$("#logoContainer").delay(1000).animate({height:"50px"},1000,"easeOutQuad");$("#navigation").hide();$("#navigation").delay(1000).fadeIn(2000);this.showStaticContent(1000);this.initLinks()};c.prototype.expandContent=function(d){if(d){this.expanded=true;$("#contentArea").animate({top:"800px"},500,"easeOutQuad")}else{this.expanded=false;$("#contentArea").animate({top:"580px"},1000,"easeOutQuad")}};c.prototype.initLinks=function(){$("#aboutUs-menuItem").click(function(){$.scrollTo("#aboutUs-content",800)});$("#contactUs-menuItem").click(function(){$.scrollTo("#contactUs-content",800)});$("#aboutTop").click(function(){$.scrollTo("#logoContainer",800)});$("#contactTop").click(function(){$.scrollTo("#logoContainer",800)})};c.prototype.showStaticContent=function(d){$("#contentArea").delay(d).fadeIn(1000)};return c})();b.UI=a})(KurstWebsite||(KurstWebsite={}));var kurst;(function(b){(function(c){var d=(function(){function f(){this.authorA="alteredq / http://alteredqualia.com/";this.authorB="mr.doob / http://mrdoob.com/";this.authorC="Karim Beyrouti / http://kurst.co.uk ( typescript conversion )"}return f})();var e=(function(){function f(){this.canvas=!!this.createCanvas();this.webgl=this.testWebGlRenderingContext();this.workers=!!window.Worker;this.fileAPI=!!(window.File&&window.FileReader&&window.FileList&&window.Blob)}f.prototype.addGetWebGLMessage=function(i){var h,j,g;i=i||{};h=i.parent!==undefined?i.parent:document.body;j=i.id!==undefined?i.id:"oldie";g=this.getWebGLErrorMessage();g.id=j;h.appendChild(g)};f.prototype.getWebGLErrorMessage=function(){var g=document.createElement("div");g.id="webgl-error-message2";g.style.fontFamily="monospace";g.style.fontSize="13px";g.style.fontWeight="normal";g.style.textAlign="center";g.style.background="#fff";g.style.color="#000";g.style.padding="1.5em";g.style.width="400px";g.style.margin="5em auto 0";g.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n"):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n");return g};f.prototype.testWebGlRenderingContext=function(){try{var g=!!this.createCanvas().getContext("experimental-webgl");var h=!!this.createCanvas().getContext("webgl");return g||h}catch(i){return false}};f.prototype.createCanvas=function(){return document.createElement("canvas")};return f})();c.Detector=e})(b.threejs||(b.threejs={}));var a=b.threejs})(kurst||(kurst={}));var controller=this;var Main;(function(h){var d;var f;var g;var i;var e;var b;var c=["#8b0000","#019601","#010192","#008b8b","#8e008e","#bbbb00"];function a(){i=new KurstWebsite.UI($);e=new KurstWebsite.BackgroundGrad();b=kurst.utils.JSUtils.getId("iFRameContent");f=new kurst.threejs.Detector();if(f.webgl){b.src="http://kurst.co.uk/samples/threejs/globe/?logo=false"}else{var k=["http://kurst.co.uk/samples/quakemap/index_s.html","http://kurst.co.uk/samples/rssvisuals/index_s.html","http://kurst.co.uk/samples/flightpaths/"];b.src=k[Math.floor(Math.random()*k.length)]}var l=$(".content-link").click(function(p){p.preventDefault();b.src=$(this).attr("uri");$.scrollTo("#logoContainer",800);e.setColour(c[Math.floor(Math.random()*c.length)])});for(var n in l){var o=l[n];var m=$(o).attr("href");$(o).attr("href","#")}$(".top-menuItem").click(function(){$.scrollTo("#logoContainer",800)});setTimeout(function(){e.setColour("#8b0000")},3000)}h.start=a;function j(){}})(Main||(Main={}));$(document).ready(function(){Main.start()});